<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Music Bio System | QuÃ½ Official</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#0d0d0d;
  color:#fff;
}
.box{
  max-width:420px;
  margin:40px auto;
  background:#161616;
  border-radius:18px;
  padding:20px;
  text-align:center;
}
.hidden{display:none}
input,textarea{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:none;
}
button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border:none;
  border-radius:12px;
  font-weight:600;
}
.green{background:#1db954}
.red{background:#ff3b3b;color:#fff}
.blue{background:#3498db}
.purple{background:#8e44ad}
.gray{background:#555;color:#fff}
.avatar{
  width:110px;height:110px;border-radius:50%;object-fit:cover;
}
.list{
  background:#222;
  padding:10px;
  border-radius:12px;
  margin-top:10px;
}
audio{width:100%;margin-top:6px}
</style>
</head>

<body>

<!-- MAINTENANCE -->
<div class="box hidden" id="maintenanceBox">
  <h2>ğŸš§ Website Ä‘ang báº£o trÃ¬</h2>
  <p>Há»‡ thá»‘ng sáº½ sá»›m quay láº¡i</p>
</div>

<!-- ADMIN LOGIN -->
<div class="box hidden" id="adminLogin">
  <h2>ğŸ‘‘ Admin Login</h2>
  <input id="adminUser" placeholder="admin">
  <input id="adminPass" type="password" placeholder="Máº­t kháº©u">
  <button class="green" onclick="loginRole('admin')">ÄÄƒng nháº­p</button>
</div>

<!-- SECRETARY LOGIN -->
<div class="box hidden" id="secretaryLogin">
  <h2>ğŸ§‘â€ğŸ’¼ ThÆ° kÃ½ Login</h2>
  <input id="secUser" placeholder="secretary">
  <input id="secPass" type="password" placeholder="Máº­t kháº©u">
  <button class="blue" onclick="loginRole('secretary')">ÄÄƒng nháº­p</button>
</div>

<!-- ASSISTANT LOGIN -->
<div class="box hidden" id="assistantLogin">
  <h2>ğŸ¤– Trá»£ lÃ½ Login</h2>
  <input id="asUser" placeholder="assistant">
  <input id="asPass" type="password" placeholder="Máº­t kháº©u">
  <button class="purple" onclick="loginRole('assistant')">ÄÄƒng nháº­p</button>
</div>

<!-- USER -->
<div class="box hidden" id="userBox">
  <img id="userAvatar" class="avatar">
  <h2 id="userName"></h2>
  <textarea id="bioText" placeholder="Bio cá»§a báº¡n"></textarea>
  <input type="file" accept="image/*" onchange="uploadAvatar(this)">
  <input type="file" accept="audio/*" onchange="uploadMusic(this)">
  <button class="green" onclick="saveBio()">LÆ°u Bio</button>
  <h3>ğŸµ Nháº¡c Ä‘Ã£ duyá»‡t</h3>
  <div id="userMusic"></div>
  <button class="red" onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

<!-- ASSISTANT PANEL -->
<div class="box hidden" id="assistantBox">
  <h2>ğŸ¤– Trá»£ lÃ½</h2>
  <div id="assistantList"></div>
  <button class="purple" onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

<!-- SECRETARY PANEL -->
<div class="box hidden" id="secretaryBox">
  <h2>ğŸ§‘â€ğŸ’¼ ThÆ° kÃ½</h2>
  <div id="secretaryList"></div>
  <button class="blue" onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

<!-- ADMIN PANEL -->
<div class="box hidden" id="adminBox">
  <h2>ğŸ‘‘ Admin Panel</h2>
  <button onclick="toggleMaintenance()">ğŸ”§ Báº­t / Táº¯t báº£o trÃ¬</button>
  <button class="red" onclick="resetSystem()">âš  Reset há»‡ thá»‘ng</button>
  <div id="adminInfo"></div>
  <button class="gray" onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

<script>
/* ===== TÃ€I KHOáº¢N Há»† THá»NG ===== */
const accounts={
  admin:{pass:"admin123",role:"admin"},
  secretary:{pass:"123456",role:"secretary"},
  assistant:{pass:"123456",role:"assistant"}
};

if(localStorage.maintenance===undefined){
  localStorage.maintenance="on";
}
if(!localStorage.musicDB){
  localStorage.musicDB=JSON.stringify([]);
}

/* ===== LOGIN RIÃŠNG ===== */
function loginRole(role){
  let u,p;
  if(role==="admin"){u=adminUser.value;p=adminPass.value;}
  if(role==="secretary"){u=secUser.value;p=secPass.value;}
  if(role==="assistant"){u=asUser.value;p=asPass.value;}

  if(accounts[u] && accounts[u].pass===p && accounts[u].role===role){
    localStorage.session=u;
    location.reload();
  }else alert("Sai thÃ´ng tin Ä‘Äƒng nháº­p");
}

/* ===== USER ===== */
function saveBio(){localStorage["bio_"+session]=bioText.value;}
function uploadAvatar(f){
  let r=new FileReader();
  r.onload=e=>localStorage["ava_"+session]=e.target.result;
  r.readAsDataURL(f.files[0]);
}
function uploadMusic(f){
  let r=new FileReader();
  r.onload=e=>{
    let db=JSON.parse(localStorage.musicDB);
    db.push({user:session,src:e.target.result,status:"pending"});
    localStorage.musicDB=JSON.stringify(db);
    loadUser();
  };
  r.readAsDataURL(f.files[0]);
}
function loadUser(){
  userBox.classList.remove("hidden");
  userName.innerText=session;
  userAvatar.src=localStorage["ava_"+session]||"https://i.imgur.com/8Km9tLL.jpg";
  bioText.value=localStorage["bio_"+session]||"";
  userMusic.innerHTML="";
  JSON.parse(localStorage.musicDB)
    .filter(m=>m.user===session && m.status==="approved")
    .forEach(m=>userMusic.innerHTML+=`<audio controls src="${m.src}"></audio>`);
}

/* ===== ASSISTANT ===== */
function loadAssistant(){
  assistantBox.classList.remove("hidden");
  assistantList.innerHTML="";
  JSON.parse(localStorage.musicDB)
    .filter(m=>m.status==="pending")
    .forEach((m,i)=>{
      assistantList.innerHTML+=`
      <div class="list">
        ${m.user}
        <audio controls src="${m.src}"></audio>
        <button onclick="checkMusic(${i})">Gá»­i Ä‘á» xuáº¥t</button>
      </div>`;
    });
}
function checkMusic(i){
  let db=JSON.parse(localStorage.musicDB);
  db[i].status="checked";
  localStorage.musicDB=JSON.stringify(db);
  loadAssistant();
}

/* ===== SECRETARY ===== */
function loadSecretary(){
  secretaryBox.classList.remove("hidden");
  secretaryList.innerHTML="";
  JSON.parse(localStorage.musicDB)
    .filter(m=>m.status==="checked")
    .forEach((m,i)=>{
      secretaryList.innerHTML+=`
      <div class="list">
        ${m.user}
        <audio controls src="${m.src}"></audio>
        <button onclick="approve(${i})">âœ… Duyá»‡t</button>
        <button class="red" onclick="reject(${i})">âŒ Tá»« chá»‘i</button>
      </div>`;
    });
}
function approve(i){
  let db=JSON.parse(localStorage.musicDB);
  db[i].status="approved";
  localStorage.musicDB=JSON.stringify(db);
  loadSecretary();
}
function reject(i){
  let db=JSON.parse(localStorage.musicDB);
  db.splice(i,1);
  localStorage.musicDB=JSON.stringify(db);
  loadSecretary();
}

/* ===== ADMIN ===== */
function loadAdmin(){
  adminBox.classList.remove("hidden");
  adminInfo.innerText="Tá»•ng bÃ i nháº¡c: "+JSON.parse(localStorage.musicDB).length;
}
function toggleMaintenance(){
  localStorage.maintenance =
    localStorage.maintenance==="on"?"off":"on";
  alert("ÄÃ£ Ä‘á»•i tráº¡ng thÃ¡i báº£o trÃ¬");
}
function resetSystem(){
  if(confirm("XÃ“A TOÃ€N Bá»˜ Há»† THá»NG?")){
    localStorage.clear();
    location.reload();
  }
}

/* ===== ÄIá»€U HÆ¯á»šNG ===== */
let session=localStorage.session;
let hash=location.hash.replace("#","");
let maintenance=localStorage.maintenance==="on";

if(session && accounts[session]){
  loadRole(accounts[session].role);
}else{
  if(hash==="admin") adminLogin.classList.remove("hidden");
  else if(hash==="secretary") secretaryLogin.classList.remove("hidden");
  else if(hash==="assistant") assistantLogin.classList.remove("hidden");
  else maintenanceBox.classList.remove("hidden");
}

function loadRole(role){
  if(role==="admin") loadAdmin();
  if(role==="secretary") loadSecretary();
  if(role==="assistant") loadAssistant();
}

function logout(){
  localStorage.removeItem("session");
  location.reload();
}
</script>

</body>
</html>